(window.webpackJsonp=window.webpackJsonp||[]).push([[207],{526:function(t,v,_){"use strict";_.r(v);var e=_(33),s=Object(e.a)({},(function(){var t=this,v=t.$createElement,_=t._self._c||v;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("h1",{attrs:{id:"前端面试其他常见问题"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#前端面试其他常见问题"}},[t._v("#")]),t._v(" 前端面试其他常见问题")]),t._v(" "),_("h2",{attrs:{id:"_1-url的输入到看到页面发生了什么？"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_1-url的输入到看到页面发生了什么？"}},[t._v("#")]),t._v(" 1.URL的输入到看到页面发生了什么？")]),t._v(" "),_("div",{staticClass:"custom-block tip"},[_("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),_("p",[_("code",[t._v("URL")]),t._v("(统一资源定位符，用于定位互联网上的资源)")]),t._v(" "),_("ul",[_("li",[_("code",[t._v("scheme://host.domain:port/path/filename")]),t._v(" "),_("ul",[_("li",[_("code",[t._v("scheme")]),t._v("：定义因特网服务类型。常见有"),_("code",[t._v("http")]),t._v("、"),_("code",[t._v("https")]),t._v("、"),_("code",[t._v("file")]),t._v("、"),_("code",[t._v("ftp")])]),t._v(" "),_("li",[_("code",[t._v("host")]),t._v("：定义域主机")]),t._v(" "),_("li",[_("code",[t._v("domain")]),t._v("：定义因特网域名")]),t._v(" "),_("li",[_("code",[t._v("port")]),t._v("：定义主机端口，"),_("code",[t._v("http")]),t._v("默认端口为"),_("code",[t._v("80")]),t._v("，"),_("code",[t._v("https")]),t._v("为"),_("code",[t._v("443")])]),t._v(" "),_("li",[_("code",[t._v("path")]),t._v("：定义服务器上的路径（如果省略代表文档在网站根目录中）")]),t._v(" "),_("li",[_("code",[t._v("filename")]),t._v("：定义文档/资源的名称")])])])])]),t._v(" "),_("blockquote",[_("p",[t._v("用户输入首先判断地址栏输入的关键字类别，是搜索内容还是请求的"),_("code",[t._v("URL")]),t._v("。如果是搜索内容，地址栏会使用浏览器默认的搜索引擎，来合成新的带搜索关键字的"),_("code",[t._v("URL")]),t._v("。如果判断输入内容符合"),_("code",[t._v("URL")]),t._v("规则，那么地址栏会根据规则把这段内容加上协议，合成完整的"),_("code",[t._v("URL")]),t._v("。标签页上的图标进入加载状态。")])]),t._v(" "),_("p",[t._v("浏览器进程会通过进程间通信把"),_("code",[t._v("URL")]),t._v("请求发送到网络进程，网络进程接收到后会发起真正的"),_("code",[t._v("URL")]),t._v("请求过程。")]),t._v(" "),_("ol",[_("li",[_("p",[t._v("网络进程会查找本地缓存是否缓存了资源，如果有缓存则返回给浏览器进程，没有则进入网络请求进程。")])]),t._v(" "),_("li",[_("p",[_("a",{attrs:{href:"/another/Net/DNS%E5%88%9D%E8%AF%86"}},[t._v("DNS解析（域名解析）")])])])]),t._v(" "),_("p",[t._v("一个递归过程\n"),_("img",{attrs:{src:"/dovis-blog/other/7.png",alt:"img"}})]),t._v(" "),_("ol",{attrs:{start:"3"}},[_("li",[t._v("发送TCP连接")])]),t._v(" "),_("blockquote",[_("p",[t._v("三次握手")])]),t._v(" "),_("ol",{attrs:{start:"4"}},[_("li",[t._v("发送"),_("code",[t._v("HTTP")]),t._v("请求")])]),t._v(" "),_("blockquote",[_("p",[t._v("发送"),_("code",[t._v("HTTP")]),t._v("请求的过程就是构建"),_("code",[t._v("HTTP")]),t._v("请求报文并通过"),_("code",[t._v("TCP")]),t._v("协议中发送到服务器指定端口 请求报文由"),_("strong",[t._v("请求行")]),t._v("，"),_("strong",[t._v("请求报头")]),t._v("，"),_("strong",[t._v("请求正文")]),t._v("组成")])]),t._v(" "),_("ol",{attrs:{start:"5"}},[_("li",[t._v("服务器处理请求并返回"),_("code",[t._v("HTTP")]),t._v("报文")]),t._v(" "),_("li",[t._v("浏览器解析渲染页面")])]),t._v(" "),_("div",{staticClass:"custom-block tip"},[_("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),_("p",[t._v("准备渲染进程，通常情况下打开新的页面会使用单独的渲染进程。如果从A页面打开B页面且在同一个站点下，那么B页面会复用A的渲染进程；如果是其他情况浏览器进程会为B创建一个新的渲染进程。"),_("strong",[t._v("渲染进程准备好之后，还不能立即进入文档解析状态，因为此时的文档数目在网络进程中，并没有提交给渲染进程，所以下一步进入提交文档的阶段。")])]),t._v(" "),_("p",[t._v("提交文档，文档指"),_("code",[t._v("URL")]),t._v("请求的响应体数据。提交文档的信息由浏览器进程发出，渲染进程收到提交文档的信息后，会和网络进程建立传输数据的管道。等文档数据传输完成之后，渲染进程会返回确认提交的信息给浏览器进程。浏览器进程在收到确认提交的信息后，会更新浏览器界面状态，包括了安全状态，地址栏的"),_("code",[t._v("URL")]),t._v("，前进后退的状态，并更新页面。")])]),t._v(" "),_("ol",{attrs:{start:"7"}},[_("li",[t._v("连接结束")])]),t._v(" "),_("blockquote",[_("p",[t._v("四次挥手")])]),t._v(" "),_("div",{staticClass:"custom-block tip"},[_("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),_("p",[t._v("详细的网页加载过程")]),t._v(" "),_("ol",[_("li",[t._v("处理输入")])]),t._v(" "),_("blockquote",[_("p",[_("code",[t._v("UI thread")]),t._v("判断是关键词搜索还是"),_("code",[t._v("URL")])])]),t._v(" "),_("ol",{attrs:{start:"2"}},[_("li",[t._v("开始导航")])]),t._v(" "),_("blockquote",[_("p",[t._v("回车后，"),_("code",[t._v("UI thread")]),t._v("将输入的内容交给网络线程"),_("code",[t._v("Network thread")]),t._v("，此时UI线程使"),_("code",[t._v("Tab")]),t._v("前图标展示为加载中状态，然后网络进程进行一系列诸如"),_("code",[t._v("DNS")]),t._v("寻址，建立"),_("code",[t._v("TLS")]),t._v("连接等操作进行资源请求，如果收到服务器的"),_("code",[t._v("301")]),t._v("重定向响应，它就会告知UI线程进行重定向然后它会再次发起一个新的网络请求。")])]),t._v(" "),_("ol",{attrs:{start:"3"}},[_("li",[t._v("读取响应")])]),t._v(" "),_("blockquote",[_("p",[_("code",[t._v("network thread")]),t._v("接收到服务器的响应后，开始解析"),_("code",[t._v("HTTP")]),t._v("响应报文，然后根据响应头中的"),_("code",[t._v("Content-Type")]),t._v("字段来确定响应主体的媒体类型（"),_("code",[t._v("MIME Type")]),t._v("），如果媒体类型是一个"),_("code",[t._v("HTML")]),t._v("文件，则将响应数据交给渲染进程（"),_("code",[t._v("renderer process")]),t._v("）来进行下一步的工作，如果是 "),_("code",[t._v("zip")]),t._v(" 文件或者其它文件，会把相关数据传输给下载管理器。")]),t._v(" "),_("p",[t._v("与此同时，浏览器会进行 "),_("code",[t._v("Safe Browsing")]),t._v(" 安全检查，如果域名或者请求内容匹配到已知的恶意站点，"),_("code",[t._v("network thread")]),t._v(" 会展示一个警告页。除此之外，网络线程还会做 "),_("code",[t._v("CORB（Cross Origin Read Blocking）")]),t._v("检查来确定那些敏感的跨站数据不会被发送至渲染进程。")])]),t._v(" "),_("ol",{attrs:{start:"4"}},[_("li",[t._v("查找渲染进程")])]),t._v(" "),_("blockquote",[_("p",[t._v("各种检查完毕以后，"),_("code",[t._v("network thread")]),t._v(" 确信浏览器可以导航到请求网页，"),_("code",[t._v("network thread")]),t._v(" 会通知 "),_("code",[t._v("UI thread")]),t._v(" 数据已经准备好，"),_("code",[t._v("UI thread")]),t._v(" 会查找到一个 "),_("code",[t._v("renderer process")]),t._v(" 进行网页的渲染。")]),t._v(" "),_("p",[t._v("浏览器为了对查找渲染进程这一步骤进行优化，考虑到网络请求获取响应需要时间，所以在第二步开始，浏览器已经预先查找和启动了一个渲染进程，如果中间步骤一切顺利，当 "),_("code",[t._v("network thread")]),t._v(" 接收到数据时，渲染进程已经准备好了，但是如果遇到重定向，这个准备好的渲染进程也许就不可用了，这个时候会重新启动一个渲染进程。")])]),t._v(" "),_("ol",{attrs:{start:"5"}},[_("li",[t._v("提交导航")])]),t._v(" "),_("blockquote",[_("p",[t._v("到了这一步，数据和渲染进程都准备好了，"),_("code",[t._v("Browser Process")]),t._v(" 会向 "),_("code",[t._v("Renderer Process")]),t._v(" 发送"),_("code",[t._v("IPC")]),t._v("消息来确认导航，此时，浏览器进程将准备好的数据发送给渲染进程，渲染进程接收到数据之后，又发送"),_("code",[t._v("IPC")]),t._v("消息给浏览器进程，告诉浏览器进程导航已经提交了，页面开始加载。")]),t._v(" "),_("p",[t._v("这个时候导航栏会更新，安全指示符更新（地址前面的小锁），访问历史列表（"),_("code",[t._v("history tab")]),t._v("）更新，即可以通过前进后退来切换该页面。")])]),t._v(" "),_("ol",{attrs:{start:"6"}},[_("li",[t._v("初始化加载完成")])]),t._v(" "),_("blockquote",[_("p",[t._v("当导航提交完成后，渲染进程开始加载资源及渲染页面，当页面渲染完成后（页面及内部的"),_("code",[t._v("iframe")]),t._v("都触发了"),_("code",[t._v("onload")]),t._v("事件），会向浏览器进程发送"),_("code",[t._v("IPC")]),t._v("消息，告知浏览器进程，这个时候"),_("code",[t._v("UI thread")]),t._v("会停止展示"),_("code",[t._v("tab")]),t._v("中的加载中图标。")])])]),t._v(" "),_("div",{staticClass:"custom-block tip"},[_("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),_("p",[t._v("网页渲染原理：")]),t._v(" "),_("ul",[_("li",[t._v("渲染进程中的多个线程：\n"),_("ul",[_("li",[t._v("一个主线程")]),t._v(" "),_("li",[t._v("多个工作线程")]),t._v(" "),_("li",[t._v("一个合成器线程")]),t._v(" "),_("li",[t._v("多个光栅化线程")])])])]),t._v(" "),_("ol",[_("li",[t._v("构建DOM")])]),t._v(" "),_("blockquote",[_("p",[t._v("当渲染进程接受到导航的确认信息后，开始接受来自浏览器进程的数据，这个时候，主线程会解析数据转化为"),_("code",[t._v("DOM（Document Object Model）")]),t._v("对象。")])]),t._v(" "),_("ol",{attrs:{start:"2"}},[_("li",[t._v("子资源加载")])]),t._v(" "),_("blockquote",[_("p",[t._v("在构建"),_("code",[t._v("DOM")]),t._v("的过程中，会解析到图片、"),_("code",[t._v("CSS")]),t._v("、"),_("code",[t._v("JavaScript")]),t._v("脚本等资源，这些资源是需要从网络或者缓存中获取的，主线程在构建"),_("code",[t._v("DOM")]),t._v("过程中如果遇到了这些资源，逐一发起请求去获取，而为了提升效率，浏览器也会运行预加载扫描（"),_("code",[t._v("preload scanner")]),t._v("）程序，如果"),_("code",[t._v("HTML")]),t._v("中存在"),_("code",[t._v("img")]),t._v("、"),_("code",[t._v("link")]),t._v("等标签，预加载扫描程序会把这些请求传递给"),_("code",[t._v("Browser Process")]),t._v("的"),_("code",[t._v("network thread")]),t._v("进行资源下载。")])]),t._v(" "),_("ol",{attrs:{start:"3"}},[_("li",[t._v("Javascript的下载与执行")])]),t._v(" "),_("blockquote",[_("p",[t._v("构建DOM过程中，如果遇到"),_("code",[t._v("<script>")]),t._v("标签，渲染引擎会停止对"),_("code",[t._v("HTML")]),t._v("的解析，而去加载执行JS代码，原因在于JS代码可能会改变"),_("code",[t._v("DOM")]),t._v("的结构")])]),t._v(" "),_("ol",{attrs:{start:"4"}},[_("li",[t._v("样式计算")])]),t._v(" "),_("blockquote",[_("p",[_("code",[t._v("DOM")]),t._v("树只是我们页面的结构，我们要知道页面长什么样子，我们还需要知道DOM的每一个节点的样式。主线程在解析页面时，遇到"),_("code",[t._v("<style>")]),t._v("标签或者"),_("code",[t._v("<link>")]),t._v("标签的"),_("code",[t._v("CSS")]),t._v("资源，会加载"),_("code",[t._v("CSS")]),t._v("代码，根据"),_("code",[t._v("CSS")]),t._v("代码确定每个"),_("code",[t._v("DOM")]),t._v("节点的计算样式（"),_("code",[t._v("computed style")]),t._v("）。")]),t._v(" "),_("p",[t._v("计算样式是主线程根据"),_("code",[t._v("CSS")]),t._v("样式选择器（"),_("code",[t._v("CSS selectors")]),t._v("）计算出的每个"),_("code",[t._v("DOM")]),t._v("元素应该具备的具体样式，即使你的页面没有设置任何自定义的样式，浏览器也会提供其默认的样式。")])]),t._v(" "),_("ol",{attrs:{start:"5"}},[_("li",[t._v("布局")])]),t._v(" "),_("blockquote",[_("p",[_("code",[t._v("DOM")]),t._v("树和计算样式完成后，我们还需要知道每一个节点在页面上的位置，布局（"),_("code",[t._v("Layout")]),t._v("）其实就是找到所有元素的几何关系的过程。")]),t._v(" "),_("p",[t._v("主线程会遍历"),_("code",[t._v("DOM")]),t._v(" 及相关元素的计算样式，构建出包含每个元素的页面坐标信息及盒子模型大小的布局树（"),_("code",[t._v("Render Tree")]),t._v("），遍历过程中，会跳过隐藏的元素（"),_("code",[t._v("display: none")]),t._v("），另外，伪元素虽然在"),_("code",[t._v("DOM")]),t._v("上不可见，但是在布局树上是可见的。")])]),t._v(" "),_("ol",{attrs:{start:"6"}},[_("li",[t._v("绘制")])]),t._v(" "),_("blockquote",[_("p",[t._v("布局 "),_("code",[t._v("layout")]),t._v(" 之后，我们知道了不同元素的结构，样式，几何关系，我们要绘制出一个页面，我们要需要知道每个元素的绘制先后顺序，在绘制阶段，主线程会遍历布局树（"),_("code",[t._v("layout tree")]),t._v("），生成一系列的绘画记录（"),_("code",[t._v("paint records")]),t._v("）。绘画记录可以看做是记录各元素绘制先后顺序的笔记。")])]),t._v(" "),_("ol",{attrs:{start:"7"}},[_("li",[t._v("合成")])]),t._v(" "),_("blockquote",[_("p",[t._v("文档结构、元素的样式、元素的几何关系、绘画顺序，这些信息我们都有了，这个时候如果要绘制一个页面，我们需要做的是把这些信息转化为显示器中的像素，这个转化的过程，叫做"),_("strong",[t._v("光栅化（"),_("code",[t._v("rasterizing")]),t._v("）")]),t._v("。")])]),t._v(" "),_("blockquote",[_("p",[t._v("合成是一种将页面分成若干层，然后分别对它们进行光栅化，最后在一个单独的线程 - **合成线程（"),_("code",[t._v("compositor thread")]),t._v("）**里面合并成一个页面的技术。当用户滚动页面时，由于页面各个层都已经被光栅化了，浏览器需要做的只是合成一个新的帧来展示滚动后的效果罢了。页面的动画效果实现也是类似，将页面上的层进行移动并构建出一个新的帧即可。")])]),t._v(" "),_("p",[_("strong",[t._v("为了实现合成技术，我们需要对元素进行分层，确定哪些元素需要放置在哪一层，主线程需要遍历渲染树来创建一棵层次树（"),_("code",[t._v("Layer Tree")]),t._v("），对于添加了 "),_("code",[t._v("will-change")]),t._v("CSS 属性的元素，会被看做单独的一层，没有"),_("code",[t._v("will-change")]),t._v(" CSS属性的元素，浏览器会根据情况决定是否要把该元素放在单独的层。")])]),t._v(" "),_("blockquote",[_("p",[t._v("一旦"),_("code",[t._v("Layer Tress")]),t._v("被创建，渲染顺序被确定，主线程会把这些信息通知给合成器线程，合成器线程开始对层次数的每一层进行光栅化。有的层的可以达到整个页面的大小，所以合成线程需要将它们切分为一块又一块的小图块（"),_("code",[t._v("tiles")]),t._v("），之后将这些小图块分别进行发送给一系列光栅线程（"),_("code",[t._v("raster threads")]),t._v("）进行光栅化，结束后光栅线程会将每个图块的光栅结果存在"),_("code",[t._v("GPU Process")]),t._v("的内存中。")])]),t._v(" "),_("p",[_("img",{attrs:{src:"/dovis-blog/other/55.png",alt:"img"}})]),t._v(" "),_("blockquote",[_("p",[t._v("合成的好处在于这个过程没有涉及到主线程，所以合成线程不需要等待样式的计算以及JavaScript完成执行。这就是为什么合成器相关的动画最流畅，如果某个动画涉及到布局或者绘制的调整，就会涉及到主线程的重新计算，自然会慢很多。")])]),t._v(" "),_("ol",{attrs:{start:"8"}},[_("li",[t._v("浏览器对事件的处理")])]),t._v(" "),_("blockquote",[_("p",[t._v("当页面渲染完毕以后，"),_("code",[t._v("TAB")]),t._v("内已经显示出了可交互的"),_("code",[t._v("WEB")]),t._v("页面，用户可以进行移动鼠标、点击页面等操作了，而当这些事件发生时候，浏览器是如何处理这些事件的呢？")]),t._v(" "),_("p",[t._v("以点击事件（"),_("code",[t._v("click event")]),t._v("）为例，让鼠标点击页面时候，首先接受到事件信息的是"),_("code",[t._v("Browser Process")]),t._v("，但是"),_("code",[t._v("Browser Process")]),t._v("只知道事件发生的类型和发生的位置，具体怎么对这个点击事件进行处理，还是由"),_("code",[t._v("Tab")]),t._v("内的"),_("code",[t._v("Renderer Process")]),t._v("进行的。"),_("code",[t._v("Browser Process")]),t._v("接受到事件后，随后便把事件的信息传递给了渲染进程，渲染进程会找到根据事件发生的坐标，找到目标对象（"),_("code",[t._v("target")]),t._v("），并且运行这个目标对象的点击事件绑定的监听函数（"),_("code",[t._v("listener")]),t._v("）。")])]),t._v(" "),_("ol",{attrs:{start:"9"}},[_("li",[t._v("渲染进程中合成器线程接收事件\n"),_("img",{attrs:{src:"/dovis-blog/other/56.png",alt:"img"}})])]),t._v(" "),_("p",[_("strong",[t._v("开发者需要注意")])]),t._v(" "),_("div",{staticClass:"language-js line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-js"}},[_("code",[t._v("document"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),_("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),_("span",{pre:!0,attrs:{class:"token string"}},[t._v("'touchstart'")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" area"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    event"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),_("span",{pre:!0,attrs:{class:"token function"}},[t._v("preventDefault")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[t._v("1")]),_("br"),_("span",{staticClass:"line-number"},[t._v("2")]),_("br"),_("span",{staticClass:"line-number"},[t._v("3")]),_("br"),_("span",{staticClass:"line-number"},[t._v("4")]),_("br"),_("span",{staticClass:"line-number"},[t._v("5")]),_("br")])]),_("blockquote",[_("p",[t._v("这一段代码给"),_("code",[t._v("body")]),t._v("元素绑定了事件监听器，也就意味着整个页面都被编辑为一个非快速滚动区域，这会使得即使你的页面的某些区域没有绑定任何事件，每次用户触发事件时，合成器线程也需要和主线程通信并等待反馈，流畅的合成器独立处理合成帧的模式就失效了。"),_("strong",[t._v("解决方式：只需要在事件监听时传递"),_("code",[t._v("passtive")]),t._v("参数为 "),_("code",[t._v("true")]),t._v("，"),_("code",[t._v("passtive")]),t._v("会告诉浏览器你既要绑定事件，又要让组合器线程直接跳过主线程的事件处理直接合成创建组合帧。")])])]),t._v(" "),_("div",{staticClass:"language-js line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-js"}},[_("code",[t._v("document"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),_("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),_("span",{pre:!0,attrs:{class:"token string"}},[t._v("'touchstart'")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" area"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        event"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),_("span",{pre:!0,attrs:{class:"token function"}},[t._v("preventDefault")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n    "),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n "),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("passive"),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 顺从浏览器默认行为，所以preventDefault失效")]),t._v("\n")])]),t._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[t._v("1")]),_("br"),_("span",{staticClass:"line-number"},[t._v("2")]),_("br"),_("span",{staticClass:"line-number"},[t._v("3")]),_("br"),_("span",{staticClass:"line-number"},[t._v("4")]),_("br"),_("span",{staticClass:"line-number"},[t._v("5")]),_("br")])]),_("ol",{attrs:{start:"10"}},[_("li",[t._v("查找事件的目标对象（"),_("code",[t._v("event target")]),t._v("）")])]),t._v(" "),_("blockquote",[_("p",[t._v("当合成器线程接收到事件信息，判定到事件发生不在非快速滚动区域后，合成器线程会向主线程发送这个时间信息，主线程获取到事件信息的第一件事就是通过命中测试（"),_("code",[t._v("hit test")]),t._v("）去找到事件的目标对象。具体的命中测试流程是遍历在绘制阶段生成的绘画记录（"),_("code",[t._v("paint records")]),t._v("）来找到包含了事件发生坐标上的元素对象。")])]),t._v(" "),_("ol",{attrs:{start:"11"}},[_("li",[t._v("浏览器对事件的优化")])]),t._v(" "),_("blockquote",[_("p",[t._v("一般我们屏幕的帧率是每秒"),_("code",[t._v("60")]),t._v("帧，也就是"),_("code",[t._v("60fps")]),t._v("，但是某些事件触发的频率超过了这个数值，比如"),_("code",[t._v("wheel，mousewheel，mousemove，pointermove，touchmove")]),t._v("，这些连续性的事件一般每秒会触发"),_("code",[t._v("60~120")]),t._v("次，假如每一次触发事件都将事件发送到主线程处理，由于屏幕的刷新速率相对来说较低，这样使得主线程会触发过量的命中测试以及JS代码，使得性能有了没必要是损耗。")])]),t._v(" "),_("blockquote",[_("p",[t._v("出于优化的目的，浏览器会合并这些连续的事件，延迟到下一帧渲染时执行，也就是"),_("code",[t._v("requestAnimationFrame")]),t._v("之前。而对于非连续性的事件，如"),_("code",[t._v("keydown，keyup，mousedown，mouseup，touchstart，touchend")]),t._v("等，会直接派发给主线程去执行。")])])])])}),[],!1,null,null,null);v.default=s.exports}}]);